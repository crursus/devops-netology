# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Окно TCP, чтобы наполнить 1 Гбит/с канал, при 300 мс RTT согласно расчёту через калькулятор будет:

   ![Proof1](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-01.png)

1. Теоретическая пропускная способность канала относительно стандартного значения процента потерь 10<sup>-6</sup> 
   
    ![Proof2](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-02.png)
   
   будут следующие:
   * **Процент потерь: 10<sup>-2</sup> %** упадет в 100 раз
   
      ![Proof4](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-04.png)
  
   * **Процент потерь: 1 %** упадет в 1000 раз
   
      ![Proof3](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-03.png)

   > Всегда думал что меньше должно быть, получается: чем больше потерь, тем реалистичней результат?   

1. Максимальная скорость передачи данных которая достижима при линке 100 Мбит/с будет **94.9 Мбит/с (11.86 Мбайт/с)**
   * Расчёт максимальной полезной нагрузки (без учёта VLAN тегирования и прочих опций):
     
      `Мах TCP Payload = (MTU-TCP-IP)/(MTU+Preambula+Frame delimiter+Ethernet header+Ethernet Frame Checksum+Interframe gap)=(1500-20-20)/(1500+7+1+14+4+12)*100%=94,9%`
     
   * Размер фрейма повлияет (соотношение служебных данных к полезным)

1. При запросе curl -I http://netology.ru с рабочей станции происходит следующее:
   * Определение IP-адреса домена netology.ru:
      * Вызывается библиотечная функция getaddrinfo()
      * Проверяется локальный файл hosts (Кеш пустой, информации нет)
      * Отправляется запрос на локальный DNS-сервер (шлюз, выделенный DNS сервер)
        * Отправляется ARP-запрос на доступный в той же подсети (либо через шлюз по умолчанию) DNS-сервер
          * С этой целью проверяются локальные таблицы кеша (IP-MAC)
          * Если нет происходит проверка таблицы маршрутизации с целью обнаружения IP адреса
          * Если IP-адрес есть там, то отправка происходит через интерфейс привязанный к этой подсети
          * Если IP-адрес не обнаружен используется интерфейс подсети шлюза по умолчанию
          * Отправляется ARP-запрос (L2)
        * Коммутатор получивший ARP-запрос проверит MAC-таблицу для определения порта пересылки
          * Если в MAC-таблице нет записи коммутатор отправляет широковещательный ARP-запрос по всем портам
          * Если нужная запись есть, то коммутатор отправляет ARP-запрос на порт с необходимым нам MAC-адресом
        * Сетевая библиотека получает IP-адрес DNS-сервера
        * Открывается порт (53), для отправки запроса к DNS-серверу
      * Если там нет записей, то локальный DNS-сервер запрашивает у провайдера (общедоступного DNS CloudFlare)
      * Если нет записей у провайдера (общедоступного DNS CloudFlare), идут дальнейшие рекурсивные запросы (вплоть до nic.ru так как зона ru.)
   * После получения IP-адреса открывается сокет и начинается инкапсуляция данных
     * TCP-сегмент с заголовками порта отправки и назначения
     * Добавляется IP-заголовок сервера и клиента
     * Добавляются заголовки с MAC-адресом клиента и шлюза
     * Сформированный фрейм (кадр) передаётся через маршрутизаторы до сервера
   * Устанавливается TCP-соединение 
     * Сервер получает пакет с SYN
     * Сервер (по готовности) отвечает SYN, ACK
     * Клиент отвечает ACK
     * Передаются данные с запросом GET HEAD / HTTP/1.1
     * Сервер отвечает строкой HTTP/1.1 301 Moved Permanently
     * Клиент инициирует FIN (Или сервер по таймауту)
     * Сервер подтверждает ACK и отправляет FIN
   * Происходит обратный процесс
   * И в терминале выводится сообщение о недоступности сайта через HTTP и необходимости использования HTTPS:
   
   ![Proof5](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-05.png)  
 
   В целом это можно долго расписывать как [тут](https://github.com/alex/what-happens-when) например. :-)
1. При разрешении доменного имени `www.google.co.uk` будет сделано 3 итеративных запроса:
   
    * к `g.root-servers.net` для разрешения TLD зоны `uk.`
    * к `nsc.nic.uk` для разрешения зоны `google.co.uk.`
    * к `ns3.google.com` для разрешения FQDN `www.google.co.uk.`

    ![Proof6](https://github.com/crursus/devops-netology/blob/main/images/proof-03-sa-07-net-06.png)
    > локальный 127.0.0.1 для виртуальной машины знающий всегда о корневых серверах в зоне ` .`наверное не нужно считать.
1. В подсети `/25` доступно для назначения хостам **126** адресов. В подсети с маской `255.248.0.0` доступно **524286** хостов.

1. В подсети `/23` больше адресов (510), в отличие от подсети `/24` (254), так как на 1 бит меньше маска подсети.

1. Разделить диапазон `10.0.0.0/8` на 128 подсетей по 131070 адресов в каждой получится. Маска у таких подсетей `/15`
