
# Домашнее задание к занятию "5.3. Введение. Экосистема. Архитектура. Жизненный цикл Docker контейнера"

1.  * Создал свой репозиторий на hub.docker.com 
    * Выбрал образ httpd
    * Создал свой форк образа
      ```shell
        docker tag httpd:latest crursus/kaa-httpd:latest
        docker push crursus/kaa-httpd
      ```
    * Реализовал функционал: 
      * запуск веб-сервера в фоне 
      ```shell 
      docker run -itd -p 8080:80 --name kaa-httpd crursus/kaa-httpd
      
      ```
      * Изменил индекс-страницу на HTML-код ниже
      ```html
        <html>
            <head>
            Hey, Netology
            </head>
            <body>
                 <h1>I’m not an DevOps yet right now</h1>
            </body>
        </html>
      ```
  * Опубликовал созданный форк в своем репозитории
    ```shell
    docker commit kaa-httpd crursus/kaa-httpd
    docker push crursus/kaa-httpd
    ```
    [Ответ в виде ссылки на докерхаб-репо](https://hub.docker.com/r/crursus/kaa-httpd "crursus/kaa-httpd")

---

- Высоконагруженное монолитное java веб-приложение;
- Nodejs веб-приложение;
- Мобильное приложение c версиями для Android и iOS;
- Шина данных на базе Apache Kafka;
- Elasticsearch кластер для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;
- Мониторинг-стек на базе Prometheus и Grafana;
- MongoDB, как основное хранилище данных для java-приложения;
- Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry.

2. Выбрал следующие зависимости сценарий-платформа(ы) подходящие для предложенных сценариев:

    | Cценарий |    Платформа (в порядке убывания приоритета)     |                                                                                                                                                                       Описание                                                                                                                                                                       |
    |:------------------------------------------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:---:|
    | Высоконагруженное монолитное java веб-приложение |      виртуальная машина, физическая машина       |                                                                                                           В сценарии содержится и ответ ("высоконагруженное монолитное"), поэтому максимум ресурсов и минимизация задержек при выполнении                                                                                                            |
    | Nodejs веб-приложение |                    контейнер                     |                                                                                                                                               Как и любое web-приложение можно развернуть в контейнере                                                                                                                                               |
    | Мобильное приложение c версиями для Android и iOS | виртуальная машина, физическая машина, контейнер | Если имеется ввиду мобильное web-приложение (возможно гибридное, но не native-приложения под сами ОС), однозначно при увеличении пользователей понадобятся ресурсы и непрерывное выполнение. Можно предположить (при текущем уровне моих знаний), что возможен сценарий при котором создаётся множество контейнеров выполняющих определённые функции |
    | Шина данных на базе Apache Kafka |      физическая машина, виртуальная машина       |                                                                                 Как понимаю это сервис обеспечивающий взаимодействие микросервисов высоконагруженных систем, а взаимодействие при недостатке ресурсов (при контейнеризации) может быть узким местом                                                                                  |
    | Elastic stack для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana | физическая машина, виртуальная машина, контейнер |                                                                                                       Полагаю в таком сценарии будет обосновано гибридное применение, особенно при "продуктивном web-приложении" и кластере нод ElasticSearch                                                                                                        |
    | Мониторинг-стек на базе Prometheus и Grafana     |                    контейнер                     |                                                                                                                                        Быстрота развёртывания, переносимость, адаптация под различные задачи                                                                                                                                         |
    | Mongodb, как основное хранилище данных для java-приложения |          виртуальная машина, контейнер           |                                                                                                                    Можно использовать контейнер наверное в случае использования распределённой БД и избыточного количества реплик                                                                                                                    |
    | Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry | физическая машина, виртуальная машина, контейнер |                                                                                                                           Идеально для обеспечения процессов непрерывной интеграции и разработки программного обеспечения                                                                                                                            |

    В целом достаточно неоднозначная ситуация. С одной стороны контейнеризацию можно использовать везде (возможно переложить часть функций на физические и виртуальные машины и с определёнными ограничениями для БД). С другой стороны для эффективности необходимо учитывать узкие места при проектировании. И как всегда использование конкретной платформы зависит от сценария.
    
---
3.  * Запустил первый контейнер из образа centos в фоновом режиме, подключив папку info из текущей рабочей директории на хостовой машине в /share/info контейнера:
      
        ```shell
        docker run -d -v /cygdrive/d/dev/docker/info:/share/info --name cos01 centos
        ```
    * Запустил второй контейнер из образа debian:latest в фоновом режиме, подключив папку info из текущей рабочей директории на хостовой машине в /info контейнера:
    
        ```shell
        docker run -d -v /cygdrive/d/dev/docker/info:/info --name deb01 debian:latest
        ```
    * Подключился к первому контейнеру с помощью exec и создал текстовый файл в /share/info:

        ```shell
        docker exec -it cos01 bash
        echo "lorem ipsum1" > /share/info/test1.txt
        ```
    * Добавил еще один файл в папку info на хостовой машине:
        
        ```shell
        echo "lorem ipsum2" > info/test2.txt
        ```
    * Подключился к второму контейнеру и отобразил листинг и содержание файлов в /info контейнера.

        ```shell
        docker exec -it deb01 bash 
        ls -la /info
        cat 
        ```
      
        ![proof01](https://github.com/crursus/devops-netology/blob/main/images/proof-05-virt-03-docker-usage-01.png)

---

4. Собрал Docker образ с Ansible:

    ```shell
    Alexey@ntbk /cygdrive/d/dev/docker/ansible
    $ docker build -t crursus/kaa-ansible:ver1 -f Dockerfile .
    ```
    Загрузил на Docker Hub:
    ```shell
    Alexey@ntbk /cygdrive/d/dev/docker/ansible
    docker push crursus/kaa-ansible:ver1
    ```
    Ссылка:
    [kaa-ansible:ver1](https://hub.docker.com/layers/crursus/kaa-ansible/ver1/images/sha256-95a108063c8a392b70781484b82fafcde3a0b5b0dbd7c2c67559216f3d9a6143?context=explore)